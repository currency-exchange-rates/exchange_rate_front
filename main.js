(()=>{"use strict";class e{static template(e){const{name:t,options:s,targetValue:o}=e,l=[];let n=-1,i="",c="Выберите валюту",a="";return s.forEach((([e,t],s)=>{const r=e===o?` ${this.OPTION_SELECTED}`:"";e===o&&(n=s,i=e,c=t,a=`/images/countries-icons/${e.toUpperCase()}.svg`);const u=`/images/countries-icons/${e.toUpperCase()}.svg`;l.push(`<li class="${this.OPTION}${r}" data-select="option" data-value="${e}" data-index="${s}">\n          <img src="${u}" alt="${e}" class="custom-option-icon"> \n          ${t}\n        </li>`)})),`\n      <button type="button" class="${this.SELECT}-toggle" name="${t}" value="${i}" data-select="toggle" data-index="${n}">\n      ${a?`<img src="${a}" alt="${i}" class="custom-option-icon">`:""}\n      ${c}</button>\n      <div class="${this.SELECT}-dropdown">\n        <ul class="${this.SELECT}__options">${l.join("")}</ul>\n      </div>\n    `}static hideOpenSelect(){document.addEventListener("click",(e=>{const t=e.target;t&&t.closest(`.${this.SELECT}`)||document.querySelectorAll(`.${this.SELECT_SHOW}`).forEach((e=>{e.classList.remove(this.SELECT_SHOW)}))}))}static create(e,t){const s="string"==typeof e?document.querySelector(e):e;return s?new this(s,t):null}constructor(t,s){this._elToggle=null;const o="string"==typeof t?document.querySelector(t):t;if(!o)throw new Error("Target element not found");this._el=o,this._params=s,this._onClickFn=this._onClick.bind(this),this._params.options&&(this._el.innerHTML=e.template(this._params),this._el.classList.add(e.SELECT)),this._elToggle=this._el.querySelector(e.DATA_TOGGLE),this._el.addEventListener("click",this._onClickFn),this._elToggle&&this._elToggle.classList.add("custom-select-toggle--down")}_onClick(t){const s=t.target;if(!s)return;const o=s.closest(e.DATA),l=null==o?void 0:o.dataset.select;"toggle"===l?this.toggle():"option"===l&&this._changeValue(s)}_updateOption(t){var s,o,l,n,i,c;const a=t.closest(`.${e.OPTION}`),r=this._el.querySelector(`.${e.OPTION_SELECTED}`);if(r&&r.classList.remove(e.OPTION_SELECTED),null==a||a.classList.add(e.OPTION_SELECTED),this._elToggle){this._elToggle.textContent=null!==(s=null==a?void 0:a.textContent)&&void 0!==s?s:"Выберите валюту",this._elToggle.value=null!==(o=null==a?void 0:a.dataset.value)&&void 0!==o?o:"",this._elToggle.dataset.index=null!==(l=null==a?void 0:a.dataset.index)&&void 0!==l?l:"-1";const e=null!==(n=null==a?void 0:a.dataset.value)&&void 0!==n?n:"",t=`/images/countries-icons/${e.toUpperCase()}.svg`;let i=this._elToggle.querySelector("img");i||(i=document.createElement("img"),this._elToggle.insertBefore(i,this._elToggle.firstChild)),i.src=t,i.alt=e,this._el.classList.remove("custom-select--open"),this._elToggle.classList.remove("custom-select-toggle--up"),this._elToggle.classList.add("custom-select-toggle--down"),this._el.classList.remove("custom-select--open")}this._el.dispatchEvent(new CustomEvent("select.change")),null===(c=(i=this._params).onSelected)||void 0===c||c.call(i,this,a)}_reset(){var t,s;const o=this._el.querySelector(`.${e.OPTION_SELECTED}`);o&&o.classList.remove(e.OPTION_SELECTED),this._elToggle&&(this._elToggle.textContent="Выберите валюту",this._elToggle.value="",this._elToggle.dataset.index="-1"),this._el.dispatchEvent(new CustomEvent("select.change")),null===(s=(t=this._params).onSelected)||void 0===s||s.call(t,this,null)}_changeValue(t){t.classList.contains(e.OPTION_SELECTED)||(this._updateOption(t),this.hide())}toggle(){const t=this._elToggle;t&&(this._el.classList.contains(e.SELECT_SHOW)?(this.hide(),t.classList.remove("custom-select-toggle--up"),t.classList.add("custom-select-toggle--down"),this._el.classList.remove("custom-select--open")):(this.show(),t.classList.remove("custom-select-toggle--down"),t.classList.add("custom-select-toggle--up"),this._el.classList.add("custom-select--open")))}show(){document.querySelectorAll(`.${e.SELECT_SHOW}`).forEach((t=>{t.classList.remove(e.SELECT_SHOW)})),this._el.classList.add(e.SELECT_SHOW)}hide(){this._el.classList.remove(e.SELECT_SHOW)}dispose(){this._el.removeEventListener("click",this._onClickFn)}get value(){var e,t;return null!==(t=null===(e=this._elToggle)||void 0===e?void 0:e.value)&&void 0!==t?t:""}set value(t){let s=!1;this._el.querySelectorAll(`.${e.OPTION}`).forEach((e=>{e.dataset.value===t&&(s=!0,this._updateOption(e))})),s||this._reset()}get selectedIndex(){var e,t;return null!==(t=null===(e=this._elToggle)||void 0===e?void 0:e.dataset.index)&&void 0!==t?t:"-1"}set selectedIndex(t){const s=this._el.querySelector(`.${e.OPTION}[data-index="${t}"]`);s?this._updateOption(s):this._reset()}}e.SELECT="custom-select",e.SELECT_SHOW="custom-select--show",e.OPTION="custom-option",e.OPTION_SELECTED="custom-option--selected",e.DATA="[data-select]",e.DATA_TOGGLE='[data-select="toggle"]',e.hideOpenSelect();const t=document.getElementById("template-info").content.querySelector(".info__item"),s=document.querySelector(".info__list");function o(e){s.prepend(e)}o(function(e){const s=t.cloneNode(!0);return s.querySelector(".info__item-text").innerText=`Данные курса предоставлены на ${e}`,s}((new Date).toLocaleString()));const l={USD:1,EUR:.85,RUB:75.5,GBP:.75,JPY:110},n=document.querySelector(".form__button-swap"),i=document.querySelector("#currency-from"),c=document.querySelector("#currency-to"),a=document.querySelector("#custom-select-container-base"),r=document.querySelector("#custom-select-container-target");e.create("#custom-select-container-base",{name:"base-currency",options:[["USD","(USD) Доллар США"],["EUR","(Euro) Евро"],["RUB","(RUB) Российский рубль"],["GBP","(GBP) Фунт стерлингов"],["JPY","(JPY) Японская иена"]]}),e.create("#custom-select-container-target",{name:"target-currency",options:[["USD","(USD) Доллар США"],["EUR","(Euro) Евро"],["RUB","(RUB) Российский рубль"],["GBP","(GBP) Фунт стерлингов"],["JPY","(JPY) Японская иена"]]}),n.addEventListener("click",(e=>{e.preventDefault(),function(){var e,t;const s=(null===(e=a.querySelector("button"))||void 0===e?void 0:e.value)||"",o=(null===(t=r.querySelector("button"))||void 0===t?void 0:t.value)||"",n=parseFloat(i.value)||0,u=(n*l[o]/l[s]).toFixed(2);i.value=u,c.value=n.toString(),a.querySelector("button").value=o,r.querySelector("button").value=s;const d=a.querySelector(`[data-value="${o}"]`),g=r.querySelector(`[data-value="${s}"]`),h=a.querySelector("button"),_=r.querySelector("button");h.innerHTML="",_.innerHTML="";const m=document.createElement("img");m.src=`/images/countries-icons/${o.toUpperCase()}.svg`,m.alt=o,h.appendChild(m);const v=document.createElement("img");if(v.src=`/images/countries-icons/${s.toUpperCase()}.svg`,v.alt=s,_.appendChild(v),d){const e=document.createTextNode(d.textContent||"");h.appendChild(e)}if(g){const e=document.createTextNode(g.textContent||"");_.appendChild(e)}}()})),i.addEventListener("input",(function(){var e,t;const s=parseFloat(i.value);if(isNaN(s))return void(c.value="");const o=(null===(e=a.querySelector("button"))||void 0===e?void 0:e.value)||"",n=(null===(t=r.querySelector("button"))||void 0===t?void 0:t.value)||"",u=(s*l[n]/l[o]).toFixed(2);c.value=u})),e.hideOpenSelect(),[{RUB:3.6725},{JPY:70.2515}].forEach((e=>{o(function(e){const s=t.cloneNode(!0),o=s.querySelector(".info__item-text");for(let t in e)o.innerText=`1 ${t} = ${e[t]}`;return s}(e))}))})();